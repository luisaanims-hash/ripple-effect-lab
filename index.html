<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>The Ripple Effect Lab</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        body {
            background: linear-gradient(to bottom, #1a3a5f, #2c5f8a);
            color: #fff;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 20px;
        }

        header {
            text-align: center;
            margin-bottom: 20px;
            width: 100%;
        }

        h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.5);
        }

        .subtitle {
            font-size: 1.2rem;
            margin-bottom: 20px;
            opacity: 0.9;
        }

        .container {
            display: flex;
            flex-direction: column;
            width: 100%;
            max-width: 1200px;
            height: 80vh;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 15px;
            overflow: hidden;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
        }

        .screen {
            display: none;
            flex-direction: column;
            height: 100%;
            padding: 20px;
        }

        .active {
            display: flex;
        }

        /* Introduction Screen Styles */
        #introduction-screen {
            align-items: center;
            justify-content: center;
            text-align: center;
        }

        .intro-content {
            max-width: 800px;
            background: rgba(255, 255, 255, 0.15);
            border-radius: 15px;
            padding: 30px;
            margin-bottom: 20px;
        }

        .intro-content h2 {
            font-size: 2rem;
            margin-bottom: 20px;
            color: #4da8da;
        }

        .intro-content p {
            font-size: 1.1rem;
            line-height: 1.6;
            margin-bottom: 15px;
            text-align: left;
        }

        .intro-content ul {
            text-align: left;
            margin: 20px 0;
            padding-left: 20px;
        }

        .intro-content li {
            margin-bottom: 10px;
            line-height: 1.5;
        }

        .highlight {
            color: #4da8da;
            font-weight: bold;
        }

        .start-lab-btn {
            background: #27ae60;
            color: white;
            border: none;
            padding: 15px 40px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1.2rem;
            transition: all 0.3s ease;
            margin-top: 20px;
        }

        .start-lab-btn:hover {
            background: #219653;
            transform: translateY(-3px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
        }

        /* Start Screen Styles */
        #start-screen {
            align-items: center;
            justify-content: center;
            text-align: center;
        }

        .scenario-list {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            width: 100%;
            margin-top: 30px;
        }

        .scenario-card {
            background: rgba(255, 255, 255, 0.15);
            border-radius: 10px;
            padding: 20px;
            cursor: pointer;
            transition: all 0.3s ease;
            border: 2px solid transparent;
        }

        .scenario-card:hover {
            background: rgba(255, 255, 255, 0.25);
            transform: translateY(-5px);
            border-color: #4da8da;
        }

        .scenario-card h3 {
            font-size: 1.5rem;
            margin-bottom: 10px;
        }

        .scenario-card p {
            opacity: 0.8;
            font-size: 0.9rem;
        }

        /* Pond Screen Styles - UPDATED */
        #pond-screen {
            flex-direction: column;
        }

        .pond-area {
            display: flex;
            flex: 1;
            gap: 20px;
            margin-bottom: 15px;
        }

        .pebbles-panel {
            width: 250px;
            background: rgba(0, 0, 0, 0.2);
            padding: 15px;
            border-radius: 10px;
            overflow-y: auto;
        }

        .pebbles-panel h2 {
            margin-bottom: 15px;
            text-align: center;
            font-size: 1.4rem;
        }

        .pebble-item {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 8px;
            padding: 12px;
            margin-bottom: 10px;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .pebble-item:hover {
            background: rgba(255, 255, 255, 0.2);
        }

        .pebble-item.active {
            background: rgba(77, 168, 218, 0.4);
            border-left: 4px solid #4da8da;
        }

        .pond-container {
            flex: 1;
            position: relative;
            background: linear-gradient(to bottom, #1e5799, #207cca);
            border-radius: 10px;
            overflow: hidden;
            display: flex;
            align-items: center;
            justify-content: center;
            min-height: 400px;
        }

        .pond {
            width: 100%;
            height: 100%;
            position: relative;
        }

        .ripple {
            position: absolute;
            border-radius: 50%;
            border: 2px solid rgba(255, 255, 255, 0.7);
            transform: translate(-50%, -50%);
            pointer-events: none;
            opacity: 0;
        }

        .ripple-text {
            position: absolute;
            background: rgba(0, 0, 0, 0.7);
            color: white;
            padding: 10px 15px;
            border-radius: 8px;
            max-width: 250px;
            font-size: 0.9rem;
            pointer-events: none;
            opacity: 0;
            transition: opacity 0.3s;
            z-index: 10;
        }

        .ripple-text.active {
            opacity: 1;
        }

        /* Controls - UPDATED */
        .controls {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin-top: 0;
            padding: 10px;
        }

        button {
            background: #4da8da;
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 0.9rem;
            transition: all 0.2s ease;
            min-width: 120px;
        }

        button:hover {
            background: #3d8fc7;
            transform: translateY(-2px);
        }

        button:disabled {
            background: #6c757d;
            cursor: not-allowed;
            transform: none;
        }

        .reset-btn {
            background: #e74c3c;
        }

        .reset-btn:hover {
            background: #c0392b;
        }

        .exit-ticket-btn {
            background: #27ae60;
        }

        .exit-ticket-btn:hover {
            background: #219653;
        }

        /* Instructions */
        .instructions {
            margin-top: 10px;
            font-size: 0.8rem;
            opacity: 0.8;
            text-align: center;
        }

        /* Exit Ticket Screen Styles */
        #exit-ticket-screen {
            align-items: center;
            justify-content: flex-start;
        }

        .exit-ticket-container {
            background: rgba(255, 255, 255, 0.15);
            border-radius: 10px;
            padding: 30px;
            width: 100%;
            max-width: 800px;
            margin-top: 20px;
        }

        .exit-ticket-container h2 {
            text-align: center;
            margin-bottom: 25px;
            font-size: 1.8rem;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: bold;
        }

        .form-group input, .form-group textarea {
            width: 100%;
            padding: 12px;
            border-radius: 5px;
            border: 1px solid #ccc;
            font-size: 1rem;
            background: rgba(255, 255, 255, 0.9);
        }

        .form-group textarea {
            min-height: 200px;
            resize: vertical;
        }

        .exit-ticket-controls {
            display: flex;
            justify-content: space-between;
            margin-top: 25px;
        }

        /* Responsive Design */
        @media (max-width: 768px) {
            .pond-area {
                flex-direction: column;
            }
            
            .pebbles-panel {
                width: 100%;
                max-height: 200px;
            }
            
            .pond-container {
                min-height: 300px;
            }

            .controls {
                flex-wrap: wrap;
            }

            button {
                min-width: 100px;
                font-size: 0.8rem;
                padding: 6px 12px;
            }

            .exit-ticket-controls {
                flex-direction: column;
                gap: 10px;
            }
        }

        /* Print Styles */
        @media print {
            body, .container {
                background: white !important;
                color: black !important;
                box-shadow: none !important;
                height: auto !important;
                min-height: auto !important;
            }

            header, .controls, .pebbles-panel, .pond-container, 
            #start-screen, #pond-screen, #introduction-screen, .instructions, 
            .exit-ticket-btn, .back-btn, .reset-btn {
                display: none !important;
            }

            #exit-ticket-screen {
                display: flex !important;
                height: auto !important;
                padding: 0 !important;
            }

            .exit-ticket-container {
                background: white !important;
                color: black !important;
                padding: 0 !important;
                margin: 0 !important;
                max-width: 100% !important;
                box-shadow: none !important;
            }

            .form-group input, .form-group textarea {
                background: white !important;
                color: black !important;
                border: 1px solid black !important;
            }

            .print-btn {
                display: none !important;
            }
        }
    </style>
</head>
<body>
    <header>
        <h1>The Ripple Effect Lab</h1>
        <p class="subtitle">An Interactive Cause & Consequence Simulator</p>
    </header>

    <div class="container">
        <!-- Introduction Screen -->
        <div id="introduction-screen" class="screen active">
            <div class="intro-content">
                <h2>Welcome to The Ripple Effect Lab!</h2>
                <p>History isn't just a collection of dates and events—it's a complex web of <span class="highlight">causes and consequences</span> that ripple through time. In this interactive lab, you'll explore how single actions can create waves of change that transform societies, economies, and environments.</p>
                
                <p><span class="highlight">How does it work?</span></p>
                <ul>
                    <li><strong>Choose a historical scenario</strong> from periods like the Gilded Age, Great Depression, or modern challenges</li>
                    <li><strong>Drop "pebbles" (causes)</strong> into our virtual pond and watch the ripples unfold</li>
                    <li><strong>Follow the chain of consequences</strong> from immediate effects to long-term impacts</li>
                    <li><strong>Discover patterns</strong> that repeat across different historical periods</li>
                </ul>
                
                <p>By the end of this lab, you'll understand how solving one problem often creates new challenges—and how we can learn from history to make better decisions today.</p>
                
                <p><span class="highlight">Ready to see how your actions today might ripple into tomorrow?</span></p>
                
                <button class="start-lab-btn" id="start-lab-btn">Start Exploring History's Ripples</button>
            </div>
        </div>

        <!-- Start Screen -->
        <div id="start-screen" class="screen">
            <h2>Select a Historical Scenario</h2>
            <div class="scenario-list" id="scenario-list">
                <!-- Scenarios will be populated by JavaScript -->
            </div>
        </div>

        <!-- Pond Screen - UPDATED STRUCTURE -->
        <div id="pond-screen" class="screen">
            <div class="pond-area">
                <div class="pebbles-panel">
                    <h2 id="scenario-title">Scenario Title</h2>
                    <div id="pebbles-list">
                        <!-- Pebbles will be populated by JavaScript -->
                    </div>
                </div>
                <div class="pond-container">
                    <div class="pond" id="pond">
                        <!-- Ripples and text will be added here by JavaScript -->
                    </div>
                </div>
            </div>
            
            <div class="controls">
                <button id="back-btn">Back to Scenarios</button>
                <button id="exit-ticket-btn" class="exit-ticket-btn">Exit Ticket</button>
                <button id="reset-btn" class="reset-btn">Reset Ripples</button>
            </div>
            <p class="instructions">Click on a cause to see its consequences ripple through history</p>
        </div>

        <!-- Exit Ticket Screen -->
        <div id="exit-ticket-screen" class="screen">
            <div class="exit-ticket-container">
                <h2>Exit Ticket</h2>
                <div class="form-group">
                    <label for="student-name">Name:</label>
                    <input type="text" id="student-name" placeholder="Enter your name">
                </div>
                <div class="form-group">
                    <label for="key-question">Key Question:</label>
                    <p id="key-question">
                        "Select one historical scenario (like the Dust Bowl or Grand Coulee Dam) and one modern scenario (like Industrial Agriculture or the 'Green' Transition).
                        <br><br>
                        Based on what you saw in the lab, what is the single most important repeating pattern or lesson you see about the relationship between solving one problem (like needing food or energy) and creating new, unintended problems for people or the environment?"
                    </p>
                </div>
                <div class="form-group">
                    <label for="student-answer">Your Answer:</label>
                    <textarea id="student-answer" placeholder="Type your response here..."></textarea>
                </div>
                <div class="exit-ticket-controls">
                    <button id="back-from-exit-btn">Back to Lab</button>
                    <button id="print-btn" class="print-btn">Print / Save as PDF</button>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Content data structure
        const content = {
            scenarios: [
                {
                    id: "gilded-age",
                    title: "The Gilded Age",
                    description: "Explore the environmental and social consequences of industrialization",
                    pebbles: [
                        {
                            title: "Unchecked Logging in Wisconsin",
                            ripples: [
                                "Millions of acres of forest are clear-cut, leaving dry 'slash' (debris) behind.",
                                "New towns (like Peshtigo) are built entirely from wood to support the booming lumber industry.",
                                "A small fire + a drought + dry 'slash' = The Great Peshtigo Fire, killing 1,500-2,500 people and destroying the ecosystem."
                            ]
                        }
                    ]
                },
                {
                    id: "great-depression",
                    title: "The Great Depression & Dust Bowl",
                    description: "Understand the interconnected causes of economic and environmental disaster",
                    pebbles: [
                        {
                            title: "Decades of Plowing Native Prairie Grass",
                            ripples: [
                                "The soil's anchor (grass roots) is gone. A massive drought begins in 1930.",
                                "The topsoil turns to dust and blows away in 'black blizzards' (Ecocide).",
                                "Farms fail, forcing mass migration ('Okies') to places like California.",
                                "Refugee camps ('Hoovervilles') spring up, leading to extreme poverty and social conflict."
                            ]
                        },
                        {
                            title: "Unregulated Bank Failures",
                            ripples: [
                                "Families lose their entire life savings.",
                                "People stop buying goods (cars, appliances, clothes).",
                                "Factories close due to lack of customers, causing mass unemployment.",
                                "Families are evicted from homes, poverty skyrockets, breadlines form."
                            ]
                        }
                    ]
                },
                {
                    id: "new-deal-rural",
                    title: "The New Deal - Rural Electrification",
                    description: "Trace the impacts of bringing electricity to rural America",
                    pebbles: [
                        {
                            title: "Pass the Rural Electrification Act (REA) of 1936",
                            ripples: [
                                "Government provides low-cost loans to rural co-ops to build electric grids.",
                                "Millions of rural families (90% by the 1950s, up from 10% in 1935) get electricity for the first time, reducing the urban/rural divide.",
                                "Demand for electric appliances (radios, refrigerators, washing machines) explodes, creating new industries and jobs.",
                                "To power these new grids, the government builds massive new power sources, primarily large-scale hydroelectric dams and coal plants."
                            ]
                        }
                    ]
                },
                {
                    id: "new-deal-dams",
                    title: "The New Deal - Big Dam Projects",
                    description: "Examine the complex legacy of large-scale infrastructure projects",
                    pebbles: [
                        {
                            title: "Build the Grand Coulee Dam on the Columbia River",
                            ripples: [
                                "Thousands of unemployed men get jobs (CCC/WPA), providing massive relief during the Depression.",
                                "The dam permanently blocks the migration paths for millions of salmon, a vital food source.",
                                "Ancestral fishing grounds for Indigenous tribes (like the Colville) are flooded and destroyed, violating treaty rights and devastating their economy and culture.",
                                "The dam provides cheap electricity for WWII industries (like aluminum plants) and massive irrigation for desert farming... but fundamentally alters the entire river ecosystem."
                            ]
                        }
                    ]
                },
                {
                    id: "modern-agriculture",
                    title: "Modern - Industrial Agriculture",
                    description: "Follow the chain of consequences from modern farming practices",
                    pebbles: [
                        {
                            title: "Widespread adoption of industrial corn/soybean 'monoculture' farming",
                            ripples: [
                                "Farmers are incentivized by subsidies and market forces to plant fence-row to fence-row, relying on chemical fertilizers and pesticides.",
                                "The soil is left bare for much of the year and is not held in place by diverse root systems.",
                                "Topsoil erodes at an alarming rate (similar to the 1930s), and chemical runoff pollutes waterways (e.g., creating the 'Dead Zone' in the Gulf of Mexico).",
                                "While crop yields are high, the soil degrades, threatening long-term food security and requiring ever-more-intensive (and expensive) chemical inputs."
                            ]
                        }
                    ]
                },
                {
                    id: "green-transition",
                    title: "Modern - The 'Green' Transition",
                    description: "Explore the unintended consequences of transitioning to renewable energy",
                    pebbles: [
                        {
                            title: "Global push for 'Green' energy (EVs, batteries) to combat climate change",
                            ripples: [
                                "Governments and corporations race to secure vast amounts of 'critical minerals' like lithium, cobalt, and copper.",
                                "Massive new mines are opened in ecologically sensitive areas and on public lands (e.g., Thacker Pass, NV) or in developing nations (e.g., Congo, Bolivia).",
                                "These large-scale mines often destroy sacred Indigenous sites, consume vast amounts of water in arid regions, and risk polluting local ecosystems.",
                                "The proposed solution to the climate crisis (which was caused by 19th/20th-century extraction) creates a new 21st-century extraction crisis, repeating the same historical pattern of displacing harm onto vulnerable communities and environments."
                            ]
                        }
                    ]
                }
            ]
        };

        // DOM Elements
        const introductionScreen = document.getElementById('introduction-screen');
        const startScreen = document.getElementById('start-screen');
        const pondScreen = document.getElementById('pond-screen');
        const exitTicketScreen = document.getElementById('exit-ticket-screen');
        const startLabBtn = document.getElementById('start-lab-btn');
        const scenarioList = document.getElementById('scenario-list');
        const scenarioTitle = document.getElementById('scenario-title');
        const pebblesList = document.getElementById('pebbles-list');
        const pond = document.getElementById('pond');
        const backBtn = document.getElementById('back-btn');
        const exitTicketBtn = document.getElementById('exit-ticket-btn');
        const resetBtn = document.getElementById('reset-btn');
        const backFromExitBtn = document.getElementById('back-from-exit-btn');
        const printBtn = document.getElementById('print-btn');

        // Current state
        let currentScenario = null;
        let activePebble = null;
        let activeRipples = [];

        // Initialize the application
        function init() {
            renderScenarios();
            setupEventListeners();
        }

        // Render scenario cards on the start screen
        function renderScenarios() {
            scenarioList.innerHTML = '';
            
            content.scenarios.forEach(scenario => {
                const scenarioCard = document.createElement('div');
                scenarioCard.className = 'scenario-card';
                scenarioCard.innerHTML = `
                    <h3>${scenario.title}</h3>
                    <p>${scenario.description}</p>
                `;
                
                // Add click event directly to each card
                scenarioCard.addEventListener('click', () => {
                    selectScenario(scenario.id);
                });
                
                scenarioList.appendChild(scenarioCard);
            });
        }

        // Set up event listeners
        function setupEventListeners() {
            // Start lab button
            startLabBtn.addEventListener('click', () => {
                introductionScreen.classList.remove('active');
                startScreen.classList.add('active');
            });
            
            // Pebble selection
            pebblesList.addEventListener('click', e => {
                const pebbleItem = e.target.closest('.pebble-item');
                if (pebbleItem) {
                    const pebbleIndex = parseInt(pebbleItem.dataset.index);
                    selectPebble(pebbleIndex);
                }
            });
            
            // Navigation buttons
            backBtn.addEventListener('click', goBackToScenarios);
            exitTicketBtn.addEventListener('click', showExitTicket);
            resetBtn.addEventListener('click', resetRipples);
            backFromExitBtn.addEventListener('click', goBackToPond);
            printBtn.addEventListener('click', printExitTicket);
        }

        // Select a scenario and show the pond screen
        function selectScenario(scenarioId) {
            currentScenario = content.scenarios.find(s => s.id === scenarioId);
            
            if (!currentScenario) return;
            
            // Update UI
            scenarioTitle.textContent = currentScenario.title;
            renderPebbles();
            
            // Switch screens
            startScreen.classList.remove('active');
            pondScreen.classList.add('active');
            
            // Reset any active ripples
            resetRipples();
        }

        // Render pebbles for the current scenario
        function renderPebbles() {
            pebblesList.innerHTML = '';
            
            currentScenario.pebbles.forEach((pebble, index) => {
                const pebbleItem = document.createElement('div');
                pebbleItem.className = 'pebble-item';
                pebbleItem.dataset.index = index;
                pebbleItem.textContent = pebble.title;
                
                pebblesList.appendChild(pebbleItem);
            });
        }

        // Select a pebble and show its ripple effects
        function selectPebble(pebbleIndex) {
            // Clear previous ripples
            resetRipples();
            
            // Update active pebble
            const pebbleItems = document.querySelectorAll('.pebble-item');
            pebbleItems.forEach(item => item.classList.remove('active'));
            pebbleItems[pebbleIndex].classList.add('active');
            
            activePebble = currentScenario.pebbles[pebbleIndex];
            
            // Create ripples
            createRipples(activePebble.ripples);
        }

        // Create ripple animations and text
        function createRipples(rippleTexts) {
            const centerX = pond.offsetWidth / 2;
            const centerY = pond.offsetHeight / 2;
            
            rippleTexts.forEach((text, index) => {
                // Create ripple element
                const ripple = document.createElement('div');
                ripple.className = 'ripple';
                
                // Size increases with each ripple
                const size = 100 + (index * 100);
                ripple.style.width = `${size}px`;
                ripple.style.height = `${size}px`;
                ripple.style.left = `${centerX}px`;
                ripple.style.top = `${centerY}px`;
                
                // Create text element
                const textElement = document.createElement('div');
                textElement.className = 'ripple-text';
                textElement.textContent = text;
                
                // Position text around the pond
                const angle = (index * 90) % 360;
                const radius = 150 + (index * 50);
                const textX = centerX + radius * Math.cos(angle * Math.PI / 180);
                const textY = centerY + radius * Math.sin(angle * Math.PI / 180);
                
                textElement.style.left = `${textX}px`;
                textElement.style.top = `${textY}px`;
                
                // Add to pond
                pond.appendChild(ripple);
                pond.appendChild(textElement);
                
                // Store references
                activeRipples.push({ripple, text: textElement});
                
                // Animate with delay
                setTimeout(() => {
                    ripple.style.transition = 'all 2s ease-out';
                    ripple.style.opacity = '1';
                    ripple.style.transform = `translate(-50%, -50%) scale(1.5)`;
                    
                    textElement.classList.add('active');
                }, index * 800);
                
                // Fade out ripple after animation
                setTimeout(() => {
                    ripple.style.opacity = '0';
                }, (index * 800) + 2000);
            });
        }

        // Reset all ripples
        function resetRipples() {
            activeRipples.forEach(({ripple, text}) => {
                if (ripple.parentNode) ripple.parentNode.removeChild(ripple);
                if (text.parentNode) text.parentNode.removeChild(text);
            });
            
            activeRipples = [];
            
            // Clear active pebble
            const activePebbleItem = document.querySelector('.pebble-item.active');
            if (activePebbleItem) {
                activePebbleItem.classList.remove('active');
            }
            
            activePebble = null;
        }

        // Go back to the scenario selection screen
        function goBackToScenarios() {
            pondScreen.classList.remove('active');
            startScreen.classList.add('active');
            resetRipples();
            currentScenario = null;
        }

        // Show the exit ticket screen
        function showExitTicket() {
            pondScreen.classList.remove('active');
            exitTicketScreen.classList.add('active');
        }

        // Go back to the pond screen from exit ticket
        function goBackToPond() {
            exitTicketScreen.classList.remove('active');
            pondScreen.classList.add('active');
        }

        // Print the exit ticket as PDF
        function printExitTicket() {
            window.print();
        }

        // Initialize the application when the DOM is loaded
        document.addEventListener('DOMContentLoaded', init);
    </script>
</body>
</html>
